# @package _global_
backbone_name: swinia

backbone:
  _target_: noise2same.backbone.swinia.SwinIA
  embed_dim: 144
  window_size: 8
  depths: [ 4, 4, 4, 4, 4 ]
  num_heads: [ 16, 16, 16, 16, 16 ]
  dilations: [ 1, 1, 1, 1, 1 ]
  shuffles: [ 1, 2, 4, 2, 1 ]
  pad_divisor: ${eval:${.window_size} * ${max:${.dilations}} * ${max:${.shuffles}}}  # used in dataset config
  input_size: ${eval:${ceil:${dataset_train.input_size} / ${.pad_divisor}} * ${.pad_divisor}}

head:
  _target_: torch.nn.Identity

optimizer:
  lr: 1e-3

scheduler:
  _target_: torch.optim.lr_scheduler.CosineAnnealingLR
  T_max: ${training.steps}
  eta_min: 1e-6